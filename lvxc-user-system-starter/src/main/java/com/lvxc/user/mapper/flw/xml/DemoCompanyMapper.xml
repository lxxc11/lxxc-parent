<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lvxc.user.mapper.flw.DemoCompanyMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.lvxc.user.entity.DemoCompany">
        <result column="id" property="id" />
        <result column="company_name" property="companyName" />
        <result column="industry_field" property="industryField" typeHandler="handler.com.lvxc.mybatisplus.JsonbTypeHandler" />
        <result column="company_qualification" property="companyQualification" typeHandler="handler.com.lvxc.mybatisplus.JsonbTypeHandler" />
        <result column="register_capital" property="registerCapital" />
        <result column="manage_state" property="manageState" />
        <result column="province" property="province" />
        <result column="province_code" property="provinceCode" />
        <result column="city" property="city" />
        <result column="city_code" property="cityCode" />
        <result column="area" property="area" />
        <result column="area_code" property="areaCode" />
        <result column="build_date" property="buildDate" />
        <result column="qualification_date_begin" property="qualificationDateBegin" />
        <result column="qualification_date_end" property="qualificationDateEnd" />
        <result column="depart_name" property="departName" />
        <result column="intro" property="intro" />
        <result column="create" property="create" />
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        id,
        company_name, industry_field, company_qualification, register_capital, manage_state, province, province_code, city, city_code, area, area_code, build_date, qualification_date_begin, qualification_date_end, depart_name, intro, create
    </sql>

    <select id="getPageList" resultMap="BaseResultMap">
        SELECT * from flw_demo_company
        <where>
            1 = 1
            <if test="dto.companyName != null and dto.companyName != ''">
                AND company_name LIKE concat('%', #{dto.companyName}::text, '%')
            </if>
            <if test="dto.industryField !=null and dto.industryField !=''">
                AND industry_field @> #{dto.industryField}::jsonb
            </if>
            <if test="dto.companyQualification !=null and dto.companyQualification !=''">
                AND company_qualification @> #{dto.companyQualification}::jsonb
            </if>
            <if test="dto.registerCapitalBegin !=null">
                AND register_capital &gt;= #{dto.registerCapitalBegin}
            </if>
            <if test="dto.registerCapitalEnd !=null">
                AND register_capital &lt;= #{dto.registerCapitalEnd}
            </if>
            <if test="dto.manageState !=null">
                AND manage_state = #{dto.manageState}
            </if>
            <if test=" dto.orderValue =='date_desc'">
                ORDER BY build_date DESC
            </if>
            <if test=" dto.orderValue =='date_asc'">
                ORDER BY build_date ASC
            </if>
            <if test="dto.orderValue =='capital_desc'">
                ORDER BY register_capital DESC
            </if>
            <if test="dto.orderValue =='capital_asc'">
                ORDER BY register_capital ASC
            </if>
        </where>
    </select>

    <select id="getList" resultType="com.lvxc.user.entity.DemoCompany">
        SELECT * from flw_demo_company
        <where>
            1 = 1
            <if test="dto.companyName != null and dto.companyName != ''">
                AND company_name LIKE concat('%', #{dto.companyName}::text, '%')
            </if>
            <if test="dto.industryField !=null and dto.industryField !=''">
                AND industry_field @> #{dto.industryField}::jsonb
            </if>
            <if test="dto.companyQualification !=null and dto.companyQualification !=''">
                AND company_qualification @> #{dto.companyQualification}::jsonb
            </if>
            <if test="dto.registerCapitalBegin !=null">
                AND register_capital &gt;= #{dto.registerCapitalBegin}
            </if>
            <if test="dto.registerCapitalEnd !=null">
                AND register_capital &lt;= #{dto.registerCapitalEnd}
            </if>
            <if test="dto.manageState !=null">
                AND manage_state = #{dto.manageState}
            </if>
            <if test=" dto.orderValue =='date_desc'">
                ORDER BY build_date DESC
            </if>
            <if test=" dto.orderValue =='date_asc'">
                ORDER BY build_date ASC
            </if>
            <if test="dto.orderValue =='capital_desc'">
                ORDER BY register_capital DESC
            </if>
            <if test="dto.orderValue =='capital_asc'">
                ORDER BY register_capital ASC
            </if>
        </where>
    </select>

</mapper>
